import{N as le,Q,r as v,j as e,S as X,U as z,V as $,x as L,W as Y,X as N,Y as ce,Z as G,_ as k,$ as ee,E as A,u as de,G as ue,a0 as pe,y as j,l as R,k as q,T as M,a1 as me,a2 as xe,a3 as fe,a4 as he,a5 as ge,a6 as ve}from"./index-D2RzZOxE.js";import{s as be,u as je,S as O,E as ye}from"./Edit-VvtwGzb-.js";import{G as P}from"./Grid-DHlN3wQ6.js";import{C as Z,a as K}from"./CardContent-DM4B8who.js";import{I as H}from"./IconButton-CrdpUguL.js";import{D as J}from"./Divider-C5GvEAwZ.js";import{M as Ce}from"./MenuItem-D4b2uCv6.js";import{I as E,V}from"./VisibilityOff-OVoZowFg.js";import{V as B}from"./Visibility-gAEE29Hq.js";const we=le(),Pe=be("div",{name:"MuiContainer",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:s}=t;return[a.root,a[`maxWidth${Q(String(s.maxWidth))}`],s.fixed&&a.fixed,s.disableGutters&&a.disableGutters]}}),Se=t=>je({props:t,name:"MuiContainer",defaultTheme:we}),ke=(t,a)=>{const s=x=>$(a,x),{classes:n,fixed:d,disableGutters:l,maxWidth:r}=t,o={root:["root",r&&`maxWidth${Q(String(r))}`,d&&"fixed",l&&"disableGutters"]};return z(o,s,n)};function Ae(t={}){const{createStyledComponent:a=Pe,useThemeProps:s=Se,componentName:n="MuiContainer"}=t,d=a(({theme:r,ownerState:o})=>({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",...!o.disableGutters&&{paddingLeft:r.spacing(2),paddingRight:r.spacing(2),[r.breakpoints.up("sm")]:{paddingLeft:r.spacing(3),paddingRight:r.spacing(3)}}}),({theme:r,ownerState:o})=>o.fixed&&Object.keys(r.breakpoints.values).reduce((x,h)=>{const y=h,g=r.breakpoints.values[y];return g!==0&&(x[r.breakpoints.up(y)]={maxWidth:`${g}${r.breakpoints.unit}`}),x},{}),({theme:r,ownerState:o})=>({...o.maxWidth==="xs"&&{[r.breakpoints.up("xs")]:{maxWidth:Math.max(r.breakpoints.values.xs,444)}},...o.maxWidth&&o.maxWidth!=="xs"&&{[r.breakpoints.up(o.maxWidth)]:{maxWidth:`${r.breakpoints.values[o.maxWidth]}${r.breakpoints.unit}`}}}));return v.forwardRef(function(o,x){const h=s(o),{className:y,component:g="div",disableGutters:S=!1,fixed:w=!1,maxWidth:I="lg",classes:b,...f}=h,p={...h,component:g,disableGutters:S,fixed:w,maxWidth:I},C=ke(p,n);return e.jsx(d,{as:g,ownerState:p,className:X(C.root,y),ref:x,...f})})}const Ne=L(e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}));function Me(t){return $("MuiAvatar",t)}Y("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const Re=t=>{const{classes:a,variant:s,colorDefault:n}=t;return z({root:["root",s,n&&"colorDefault"],img:["img"],fallback:["fallback"]},Me,a)},Ie=N("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:s}=t;return[a.root,a[s.variant],s.colorDefault&&a.colorDefault]}})(ce(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(t.vars||t).palette.background.default,...t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:{backgroundColor:t.palette.grey[400],...t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})}}}]}))),We=N("img",{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),Te=N(Ne,{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"});function Fe({crossOrigin:t,referrerPolicy:a,src:s,srcSet:n}){const[d,l]=v.useState(!1);return v.useEffect(()=>{if(!s&&!n)return;l(!1);let r=!0;const o=new Image;return o.onload=()=>{r&&l("loaded")},o.onerror=()=>{r&&l("error")},o.crossOrigin=t,o.referrerPolicy=a,o.src=s,n&&(o.srcset=n),()=>{r=!1}},[t,a,s,n]),d}const De=v.forwardRef(function(a,s){const n=G({props:a,name:"MuiAvatar"}),{alt:d,children:l,className:r,component:o="div",slots:x={},slotProps:h={},imgProps:y,sizes:g,src:S,srcSet:w,variant:I="circular",...b}=n;let f=null;const p={...n,component:o,variant:I},C=Fe({...y,...typeof h.img=="function"?h.img(p):h.img,src:S,srcSet:w}),W=S||w,T=W&&C!=="error";p.colorDefault=!T,delete p.ownerState;const c=Re(p),[u,i]=k("root",{ref:s,className:X(c.root,r),elementType:Ie,externalForwardedProps:{slots:x,slotProps:h,component:o,...b},ownerState:p}),[m,D]=k("img",{className:c.img,elementType:We,externalForwardedProps:{slots:x,slotProps:{img:{...y,...h.img}}},additionalProps:{alt:d,src:S,srcSet:w,sizes:g},ownerState:p}),[F,_]=k("fallback",{className:c.fallback,elementType:Te,externalForwardedProps:{slots:x,slotProps:h},shouldForwardComponentProp:!0,ownerState:p});return T?f=e.jsx(m,{...D}):l||l===0?f=l:W&&d?f=d[0]:f=e.jsx(F,{..._}),e.jsx(u,{...i,children:f})});function He(t){return $("MuiCardActions",t)}Y("MuiCardActions",["root","spacing"]);const Ue=t=>{const{classes:a,disableSpacing:s}=t;return z({root:["root",!s&&"spacing"]},He,a)},ze=N("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:s}=t;return[a.root,!s.disableSpacing&&a.spacing]}})({display:"flex",alignItems:"center",padding:8,variants:[{props:{disableSpacing:!1},style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),te=v.forwardRef(function(a,s){const n=G({props:a,name:"MuiCardActions"}),{disableSpacing:d=!1,className:l,...r}=n,o={...n,disableSpacing:d},x=Ue(o);return e.jsx(ze,{className:X(x.root,l),ownerState:o,ref:s,...r})});function $e(t){return $("MuiCardHeader",t)}const U=Y("MuiCardHeader",["root","avatar","action","content","title","subheader"]),Le=t=>{const{classes:a}=t;return z({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},$e,a)},Ge=N("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(t,a)=>[{[`& .${U.title}`]:a.title},{[`& .${U.subheader}`]:a.subheader},a.root]})({display:"flex",alignItems:"center",padding:16}),_e=N("div",{name:"MuiCardHeader",slot:"Avatar"})({display:"flex",flex:"0 0 auto",marginRight:16}),Ee=N("div",{name:"MuiCardHeader",slot:"Action"})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),Ve=N("div",{name:"MuiCardHeader",slot:"Content"})({flex:"1 1 auto",[`.${ee.root}:where(& .${U.title})`]:{display:"block"},[`.${ee.root}:where(& .${U.subheader})`]:{display:"block"}}),ae=v.forwardRef(function(a,s){const n=G({props:a,name:"MuiCardHeader"}),{action:d,avatar:l,component:r="div",disableTypography:o=!1,subheader:x,subheaderTypographyProps:h,title:y,titleTypographyProps:g,slots:S={},slotProps:w={},...I}=n,b={...n,component:r,disableTypography:o},f=Le(b),p={slots:S,slotProps:{title:g,subheader:h,...w}};let C=y;const[W,T]=k("title",{className:f.title,elementType:A,externalForwardedProps:p,ownerState:b,additionalProps:{variant:l?"body2":"h5",component:"span"}});C!=null&&C.type!==A&&!o&&(C=e.jsx(W,{...T,children:C}));let c=x;const[u,i]=k("subheader",{className:f.subheader,elementType:A,externalForwardedProps:p,ownerState:b,additionalProps:{variant:l?"body2":"body1",color:"textSecondary",component:"span"}});c!=null&&c.type!==A&&!o&&(c=e.jsx(u,{...i,children:c}));const[m,D]=k("root",{ref:s,className:f.root,elementType:Ge,externalForwardedProps:{...p,...I,component:r},ownerState:b}),[F,_]=k("avatar",{className:f.avatar,elementType:_e,externalForwardedProps:p,ownerState:b}),[re,oe]=k("content",{className:f.content,elementType:Ve,externalForwardedProps:p,ownerState:b}),[ne,ie]=k("action",{className:f.action,elementType:Ee,externalForwardedProps:p,ownerState:b});return e.jsxs(m,{...D,children:[l&&e.jsx(F,{..._,children:l}),e.jsxs(re,{...oe,children:[C,c]}),d&&e.jsx(ne,{...ie,children:d})]})}),Be=Ae({createStyledComponent:N("div",{name:"MuiContainer",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:s}=t;return[a.root,a[`maxWidth${Q(String(s.maxWidth))}`],s.fixed&&a.fixed,s.disableGutters&&a.disableGutters]}}),useThemeProps:t=>G({props:t,name:"MuiContainer"})}),qe=L(e.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"})),Oe=L([e.jsx("circle",{cx:"12",cy:"12",r:"3.2"},"0"),e.jsx("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")]),se=L(e.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"})),Je=[{value:"alabama",label:"Alabama"}];function Qe({user:t,editing:a,onAvatarChange:s}){return e.jsxs(Z,{children:[e.jsx(K,{children:e.jsxs(O,{spacing:2,sx:{alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative"},children:[e.jsx(De,{src:t.profile_picture||t.avatar,sx:{height:"100px",width:"100px"}}),a&&e.jsxs("label",{htmlFor:"avatar-upload",children:[e.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",onChange:s,style:{display:"none"}}),e.jsx(H,{component:"span",sx:{position:"absolute",bottom:0,right:0,backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:e.jsx(Oe,{sx:{color:"white"}})})]})]}),e.jsxs(O,{spacing:1,sx:{textAlign:"center"},children:[e.jsx(A,{variant:"h5",children:t.name}),e.jsxs(A,{color:"text.secondary",variant:"body2",children:[t.city," ",t.country]}),e.jsx(A,{color:"text.secondary",variant:"body2",children:t.timezone})]})]})}),e.jsx(J,{}),e.jsx(te,{children:e.jsx(R,{fullWidth:!0,variant:"text",component:"label",htmlFor:"avatar-upload",children:"Upload picture"})})]})}function Xe({user:t,editing:a,onChange:s,onSave:n,onCancel:d}){return e.jsxs(Z,{children:[e.jsx(ae,{subheader:"The information can be edited",title:"Profile Details"}),e.jsx(J,{}),e.jsx(K,{children:e.jsxs(P,{container:!0,spacing:3,children:[e.jsx(P,{item:!0,md:6,xs:12,children:e.jsx(M,{fullWidth:!0,label:"First name",name:"firstName",value:t.firstName||"",onChange:s,disabled:!a,required:!0,size:"small"})}),e.jsx(P,{item:!0,md:6,xs:12,children:e.jsx(M,{fullWidth:!0,label:"Last name",name:"lastName",value:t.lastName||"",onChange:s,disabled:!a,required:!0,size:"small"})}),e.jsx(P,{item:!0,md:6,xs:12,children:e.jsx(M,{fullWidth:!0,label:"Email address",name:"email",value:t.email||"",onChange:s,disabled:!a,required:!0,size:"small"})}),e.jsx(P,{item:!0,md:6,xs:12,children:e.jsx(M,{fullWidth:!0,label:"Phone number",name:"phone",type:"tel",value:t.phone||"",onChange:s,disabled:!a,size:"small"})}),e.jsx(P,{item:!0,md:6,xs:12,children:e.jsxs(me,{fullWidth:!0,disabled:!a,sx:{minWidth:120},children:[e.jsx(xe,{children:"State"}),e.jsx(fe,{value:t.state||"",label:"State",name:"state",size:"small",onChange:s,sx:{minWidth:200,"& .MuiSelect-select":{padding:"12px 14px"}},children:Je.map(l=>e.jsx(Ce,{value:l.value,children:l.label},l.value))})]})}),e.jsx(P,{item:!0,md:6,xs:12,children:e.jsx(M,{fullWidth:!0,label:"City",name:"city",value:t.city||"",onChange:s,size:"small",disabled:!a})})]})}),e.jsx(J,{}),a&&e.jsxs(te,{sx:{justifyContent:"flex-end",p:2},children:[e.jsx(R,{variant:"outlined",onClick:d,sx:{mr:1},children:"Cancel"}),e.jsx(R,{variant:"contained",onClick:n,children:"Save details"})]})]})}function Ye({open:t,onClose:a,onSubmit:s,passwordData:n,onChange:d,loading:l,showPassword:r,toggleShowPassword:o}){return e.jsx(he,{open:t,onClose:a,children:e.jsxs(q,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:1},children:[e.jsxs(A,{variant:"h6",component:"h2",sx:{mb:2,display:"flex",alignItems:"center"},children:[e.jsx(se,{sx:{mr:1}})," Change Password"]}),e.jsx(M,{fullWidth:!0,label:"Current Password",type:r.current?"text":"password",name:"currentPassword",value:n.currentPassword,onChange:d,margin:"normal",InputProps:{endAdornment:e.jsx(E,{position:"end",children:e.jsx(H,{onClick:()=>o("current"),edge:"end",children:r.current?e.jsx(V,{}):e.jsx(B,{})})})}}),e.jsx(M,{fullWidth:!0,label:"New Password",type:r.new?"text":"password",name:"newPassword",value:n.newPassword,onChange:d,margin:"normal",InputProps:{endAdornment:e.jsx(E,{position:"end",children:e.jsx(H,{onClick:()=>o("new"),edge:"end",children:r.new?e.jsx(V,{}):e.jsx(B,{})})})}}),e.jsx(M,{fullWidth:!0,label:"Confirm New Password",type:r.confirm?"text":"password",name:"confirmPassword",value:n.confirmPassword,onChange:d,margin:"normal",InputProps:{endAdornment:e.jsx(E,{position:"end",children:e.jsx(H,{onClick:()=>o("confirm"),edge:"end",children:r.confirm?e.jsx(V,{}):e.jsx(B,{})})})}}),e.jsxs(q,{sx:{mt:3,display:"flex",justifyContent:"flex-end"},children:[e.jsx(R,{onClick:a,sx:{mr:1},children:"Cancel"}),e.jsx(R,{variant:"contained",onClick:s,disabled:l,children:l?"Changing...":"Change Password"})]})]})})}const it=()=>{const[t,a]=v.useState({profile_picture:"",name:"",firstName:"",lastName:"",email:"",phone:"",avatar:"",city:"",country:"",state:"",timezone:"GTM-7",joined:""}),[s,n]=v.useState(!1),[d,l]=v.useState(!1),[r,o]=v.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[x,h]=v.useState({current:!1,new:!1,confirm:!1}),[y,g]=v.useState(!1),S=de(),w=ue();v.useEffect(()=>{I()},[]);const I=async()=>{var c,u;try{const i=await pe(w.userName);i?a({...t,profile_picture:i.profile_picture||"",name:i.username||"",firstName:i.firstName||((c=i.name)==null?void 0:c.split(" ")[0])||"",lastName:i.lastName||((u=i.name)==null?void 0:u.split(" ")[1])||"",email:i.email||"",phone:i.phone||"",avatar:i.avatar||"",city:i.city||"Not specified",country:i.country||"",state:i.state||"",joined:new Date(i.date_joined).toLocaleDateString()||"Unknown"}):j.error("Failed to load user details")}catch{j.error("Failed to load user details")}},b=c=>{const{name:u,value:i}=c.target;a(m=>({...m,[u]:i}))},f=c=>{const{name:u,value:i}=c.target;o(m=>({...m,[u]:i}))},p=async()=>{try{g(!0);const c={first_name:t.firstName,last_name:t.lastName,profile_picture:t.profile_picture},u=await ge(t.name,c);j.success("Profile updated successfully"),n(!1)}catch(c){j.error("Failed to update profile"),console.error(c)}},C=async()=>{var c,u;if(r.newPassword!==r.confirmPassword){j.error("New passwords do not match");return}if(r.newPassword.length<6){j.error("New password must be at least 6 characters long");return}g(!0);try{const i={old_password:r.currentPassword,new_password:r.newPassword},m=await ve(w.userName,i);m?(j.success(m==null?void 0:m.message),l(!1),o({currentPassword:"",newPassword:"",confirmPassword:""})):j.error((m==null?void 0:m.message)||"Failed to change password")}catch(i){j.error(((u=(c=i.response)==null?void 0:c.data)==null?void 0:u.message)||"An error occurred while changing password")}finally{g(!1)}},W=c=>{const u=c.target.files[0];if(!u)return;if(!["image/jpeg","image/png"].includes(u.type)){j.error("Only JPG/PNG images are allowed");return}if(u.size>2*1024*1024){j.error("Image must be less than 2MB");return}const i=new FileReader;i.onload=m=>{a(D=>{var F;return{...D,profile_picture:(F=m.target)==null?void 0:F.result}}),j.success("Avatar updated successfully")},i.readAsDataURL(u)},T=c=>{h(u=>({...u,[c]:!u[c]}))};return e.jsxs(Be,{sx:{py:4},children:[e.jsx(R,{startIcon:e.jsx(qe,{}),onClick:()=>S(-1),sx:{mb:3},children:"Back"}),e.jsxs(P,{container:!0,spacing:3,alignItems:"flex-start",children:[e.jsx(P,{item:!0,xs:12,md:"auto",children:e.jsx(q,{sx:{width:300},children:e.jsxs(O,{spacing:3,children:[e.jsx(Qe,{user:t,editing:s,onAvatarChange:W}),e.jsxs(Z,{children:[e.jsx(ae,{title:"Security"}),e.jsxs(K,{children:[e.jsx(A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Last changed 2 months ago"}),e.jsx(R,{variant:"outlined",fullWidth:!0,startIcon:e.jsx(se,{}),onClick:()=>l(!0),children:"Change Password"})]})]})]})})}),e.jsxs(P,{item:!0,xs:12,md:!0,sx:{width:730},children:[e.jsx(Xe,{user:t,editing:s,onChange:b,onSave:p,onCancel:()=>n(!1)}),!s&&e.jsx(R,{variant:"contained",startIcon:e.jsx(ye,{}),onClick:()=>n(!0),sx:{mt:3},children:"Edit Profile"})]})]}),e.jsx(Ye,{open:d,onClose:()=>l(!1),onSubmit:C,passwordData:r,onChange:f,loading:y,showPassword:x,toggleShowPassword:T})]})};export{it as default};
